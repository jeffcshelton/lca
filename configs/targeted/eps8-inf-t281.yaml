# Base configuration for compression-activated adversarial attacks

experiment:
  name: "compression_attack_baseline"
  seed: 67
  device: "cuda"  # cuda or cpu
  num_workers: 4

data:
  dataset: "imagenet"  # imagenet, imagenet100, cifar10
  data_dir: "./data"
  batch_size: 32
  num_samples: 100  # Number of images to attack (-1 for all)
  image_size: 224
  normalize: true  # Use ImageNet normalization

model:
  architecture: "resnet50"  # resnet50, inception_v3, vgg16
  pretrained: true
  num_classes: 1000

attack:
  type: "compression_pgd"  # Type of attack
  target: 281

  # PGD parameters
  epsilon: 8  # Maximum perturbation (in [0, 255] scale)
  alpha: 2  # Step size
  num_steps: 100  # Number of optimization steps
  norm: "linf"  # linf or l2

  # Compression parameters
  jpeg_quality_min: 50  # Minimum JPEG quality to sample
  jpeg_quality_max: 95  # Maximum JPEG quality to sample
  num_jpeg_samples: 5  # Number of quality values to sample per step (EoT)
  use_ste: true  # Use straight-through estimator in Diff-JPEG

  # Loss function weights
  loss_weights:
    pre_compression: 0.5  # Minimize loss pre-compression (benign)
    post_compression: 1.0  # Maximize loss post-compression (adversarial)
    lpips: 0.0  # Perceptual similarity constraint
    tv_norm: 0.0  # Total variation for smoothness

evaluation:
  # Test with real JPEG compression
  real_jpeg_qualities: [50, 75, 85, 95]

  # Save adversarial examples
  save_examples: true
  num_examples_to_save: 20

output:
  output_dir: "./experiments/eps8-inf-t281"
  save_final_model: true
